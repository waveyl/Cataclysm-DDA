[
  {
    "//": "TODO check text, maybe rewrite something to be not this lame, balance him",
    "type": "npc",
    "id": "NPC_drunken_master",
    "gender": "male",
    "name_suffix": "醉酒大师",
    "class": "NC_drunken_master",
    "attitude": 0,
    "mission": 7,
    "chat": "TALK_drunken_master_1",
    "faction": "no_faction",
    "mission_offered": "MISSION_drunken_master_1"
  },
  {
    "type": "npc_class",
    "id": "NC_drunken_master",
    "name": {
      "str": "Drunken master"
    },
    "job_description": "Drunken master.",
    "common": false,
    "bonus_str": {
      "rng": [
        0,
        6
      ]
    },
    "bonus_dex": {
      "rng": [
        2,
        6
      ]
    },
    "bonus_int": {
      "rng": [
        4,
        6
      ]
    },
    "bonus_per": {
      "rng": [
        0,
        4
      ]
    },
    "weapon_override": "EMPTY_GROUP",
    "carry_override": "EMPTY_GROUP",
    "traits": [
      {
        "group": "Appearance_demographics"
      },
      {
        "group": "NPC_starting_traits"
      },
      {
        "trait": "BGSS_drunken_master"
      }
    ],
    "skills": [
      {
        "skill": "unarmed",
        "bonus": {
          "rng": [
            4,
            8
          ]
        }
      },
      {
        "skill": "dodge",
        "bonus": {
          "rng": [
            4,
            8
          ]
        }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": [
      "TALK_drunken_master_1",
      "TALK_drunken_master_brew_nope",
      "TALK_drunken_master_Background_style",
      "TALK_drunken_master_rest"
    ],
    "dynamic_line": "<greet>",
    "speaker_effect": {
      "effect": [
        {
          "set_npc_engagement_rule": "ENGAGE_ALL"
        },
        {
          "toggle_npc_rule": "follow_distance_2"
        },
        {
          "toggle_npc_rule": "allow_pulp"
        }
      ]
    },
    "responses": [
      {
        "text": "关于那个任务……",
        "topic": "TALK_MISSION_INQUIRE",
        "condition": "has_assigned_mission"
      },
      {
        "text": "<BGSS_intro_question>",
        "topic": "TALK_drunken_master_Background"
      },
      {
        "text": "你的药水准备好了吗？",
        "condition": {
          "npc_has_var": "wait",
          "type": "general",
          "context": "brew",
          "value": "yes"
        },
        "trial": {
          "type": "CONDITION",
          "condition": {
            "not": {
              "npc_compare_time_since_var": "wait_time",
              "type": "general",
              "context": "brew",
              "op": "<",
              "time": "1 day"
            }
          }
        },
        "success": {
          "topic": "TALK_drunken_master_brew_ready"
        },
        "failure": {
          "topic": "TALK_drunken_master_brew_nope"
        },
        "switch": true
      },
      {
        "text": "需要帮忙么？",
        "condition": {
          "npc_has_var": "master_mission",
          "type": "flag",
          "context": "mission",
          "value": "yes"
        },
        "trial": {
          "type": "CONDITION",
          "condition": {
            "not": {
              "npc_has_effect": "dm_brew"
            }
          }
        },
        "success": {
          "topic": "TALK_MISSION_LIST"
        },
        "failure": {
          "topic": "TALK_drunken_master_rest"
        },
        "switch": true
      },
      {
        "text": "如果你想和我一起旅行，我们走吧。",
        "topic": "TALK_DONE",
        "condition": {
          "and": [
            {
              "npc_has_var": "u_helped_drunken_master",
              "type": "general",
              "context": "meeting",
              "value": "yes"
            },
            {
              "not": {
                "npc_has_var": "drunken_master_teach",
                "type": "general",
                "context": "meeting",
                "value": "yes"
              }
            }
          ]
        },
        "effect": "follow"
      },
      {
        "text": "你能教我点什么吗？",
        "condition": {
          "npc_has_var": "master_mission",
          "type": "flag",
          "context": "mission",
          "value": "yes"
        },
        "topic": "TALK_drunken_master_teach_check"
      },
      {
        "text": "再见。",
        "topic": "TALK_DONE"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_Background",
    "dynamic_line": "在<the_cataclysm>之前，我周游了全国。白天我在街上表演各种节目赚钱，晚上我去酒吧寻找稀有的酒。因为我真的很喜欢喝酒，所以我不得不喝得有点醉，我的活动常常以打架告终。因此，我渐渐提高了我的技能，很快掌握了自己成熟的战斗风格。",
    "responses": [
      {
        "text": "你能教我你的格斗风格吗？",
        "topic": "TALK_drunken_master_Background_style",
        "condition": {
          "not": {
            "npc_has_var": "master_mission",
            "type": "flag",
            "context": "mission",
            "value": "yes"
          }
        },
        "effect": {
          "npc_add_var": "master_mission",
          "type": "flag",
          "context": "mission",
          "value": "yes"
        }
      },
      {
        "text": "<done_conversation_section>",
        "topic": "TALK_NONE"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_Background_style",
    "dynamic_line": "嗯，我不是个好老师，但既然我喜欢你，我可以试试。但请记住，我会为我的工作收取少量费用。我不是为了寻找最稀有的酒而离开的。我找到了一堆药水食谱，我需要制作它们的原料。如果你能帮我找到配料，我会帮你学习我的格斗风格。"
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_brew_nope",
    "dynamic_line": "耐心点，准备尚不完全。此种情况下，最重要的是耐心，否则你将一事无成。"
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_rest",
    "dynamic_line": "我需要休息，<name_g>。我们以后再干吧。"
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_brew_ready",
    "dynamic_line": "“万事俱备了，<name_g>。”他神秘地眨了眨眼，“要不要试试我们的‘药水’？”",
    "responses": [
      {
        "text": "我们开始吧！",
        "topic": "TALK_drunken_master_brew_drink",
        "effect": [
          {
            "npc_lose_var": "wait",
            "type": "general",
            "context": "brew"
          }
        ]
      },
      {
        "text": "下次再说吧。",
        "topic": "TALK_NONE"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_brew_drink",
    "dynamic_line": {
      "and": [
        "*staggered a little, exhaled poisonous vapor from his mouth, due to which the flies flying nearby fell dead, and said: \"UHH, IT'S GOOD!  I FEEL SUCH A Rush of STRENGTH AND ENERGY, THAT I AM READY TO RIP EVERYONE AND EVERYTHING!  Let's bet I can kill more <zombies> than you can until we sober up?",
        {
          "npc_has_var": "master_mission",
          "type": "count",
          "context": "mission",
          "value": "2",
          "yes": "I want more!  Let's go find the toughest <zombies>, the most powerful!  35 strong ones will be enough.",
          "no": {
            "npc_has_var": "master_mission",
            "type": "count",
            "context": "mission",
            "value": "1",
            "yes": "It was easy last time.  This time, let's go 200!",
            "no": "For our first bet, let's say 100 <zombies>."
          }
        }
      ]
    },
    "responses": [
      {
        "text": "好吧，让我们试试！",
        "topic": "TALK_DONE",
        "effect": [
          "assign_mission",
          {
            "npc_first_topic": "TALK_drunken_master_mayhem"
          },
          "follow_only"
        ]
      },
      {
        "text": "<no>，我可不想。",
        "topic": "TALK_drunken_master_refuse"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_refuse",
    "dynamic_line": "怕输吗？那我要去别的地方找更值得一战的对手了。",
    "responses": [
      {
        "text": "让我再想想。",
        "topic": "TALK_NONE"
      },
      {
        "text": "滚开，你这个酒鬼。",
        "topic": "TALK_DONE",
        "effect": [
          "leave",
          "end_conversation"
        ]
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_mayhem",
    "dynamic_line": {
      "has_assigned_mission": true,
      "yes": "我还在前面！",
      "no": "好吧，我承认你赢了。现在让我们休息一下。"
    },
    "responses": [
      {
        "text": "让我们数点分数。",
        "condition": "mission_complete",
        "trial": {
          "type": "CONDITION",
          "condition": {
            "u_has_effect": "dm_brew"
          }
        },
        "success": {
          "effect": "mission_success",
          "topic": "TALK_MISSION_SUCCESS"
        },
        "failure": {
          "effect": "mission_failure",
          "topic": "TALK_MISSION_FAILURE"
        }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_teach_check",
    "dynamic_line": "你帮过我了吗，学生？",
    "responses": [
      {
        "text": "是的，主人。",
        "condition": {
          "npc_has_var": "u_helped_drunken_master",
          "type": "general",
          "context": "meeting",
          "value": "yes"
        },
        "trial": {
          "type": "CONDITION",
          "condition": {
            "npc_has_var": "drunken_master_teach",
            "type": "general",
            "context": "meeting",
            "value": "yes"
          }
        },
        "success": {
          "effect": [
            {
              "u_spawn_item": "manual_zui_quan"
            },
            {
              "npc_lose_var": "drunken_master_teach",
              "type": "general",
              "context": "meeting"
            }
          ],
          "topic": "TALK_drunken_master_teach"
        },
        "failure": {
          "topic": "TALK_drunken_master_teach_done"
        }
      },
      {
        "text": "下次再说吧。",
        "topic": "TALK_NONE"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_teach",
    "dynamic_line": "我学会的所有东西都来自这本书。而你可以拿走了。",
    "responses": [
      {
        "text": "多谢师父。",
        "topic": "TALK_drunken_master_1"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_drunken_master_teach_done",
    "dynamic_line": "我已经把我知道的都教给你了。",
    "responses": [
      {
        "text": "再次感谢师父",
        "topic": "TALK_DONE"
      }
    ]
  },
  {
    "id": "MISSION_drunken_master_1",
    "type": "mission_definition",
    "has_generic_rewards": false,
    "name": {
      "str": "白酒配料"
    },
    "description": "收集：\n<color_light_blue> 12颗松果</color>\n<color_light_blue> 8份柳树皮</color>\n<color_light_blue> 4份香蒲杆</color>\n<color_light_blue> 2朵荷花</color>",
    "goal": "MGOAL_CONDITION",
    "goal_condition": {
      "and": [
        {
          "u_has_items": {
            "item": "pinecone",
            "count": 12
          }
        },
        {
          "u_has_items": {
            "item": "birchbark",
            "count": 8
          }
        },
        {
          "u_has_items": {
            "item": "cattail_stalk",
            "count": 4
          }
        },
        {
          "u_has_items": {
            "item": "lotus",
            "count": 2
          }
        }
      ]
    },
    "difficulty": 0,
    "value": 0,
    "end": {
      "effect": [
        {
          "u_consume_item": "pinecone",
          "count": 12
        },
        {
          "u_consume_item": "birchbark",
          "count": 8
        },
        {
          "u_consume_item": "cattail_stalk",
          "count": 4
        },
        {
          "u_consume_item": "lotus",
          "count": 2
        },
        {
          "npc_add_var": "wait_time",
          "type": "general",
          "context": "brew",
          "time": true
        },
        {
          "npc_add_var": "wait",
          "type": "general",
          "context": "brew",
          "value": "yes"
        }
      ]
    },
    "origins": [
      "ORIGIN_SECONDARY"
    ],
    "followup": "MISSION_drunken_master_2",
    "dialogue": {
      "describe": "-",
      "offer": "所以，下一杯我需要：松果，12片；桦皮，8片；蒲茎，4片；莲花，2片。把这些配料给我，我要试着从中煮些东西。",
      "accepted": "很好，等你的消息。",
      "rejected": "呸。",
      "advice": "<yawn>",
      "inquire": "你拿到东西了吗？",
      "success": "好吧，现在我需要一些时间让这些东西在我的秘密瓶子里冲泡……据我估计，要花一整天的时间。晚点再来。",
      "success_lie": "-",
      "failure": "-"
    }
  },
  {
    "id": "MISSION_drunken_master_2",
    "type": "mission_definition",
    "has_generic_rewards": false,
    "name": {
      "str": "醉酒大赛"
    },
    "description": "在你清醒之前杀死100个丧尸。",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "ZOMBIE",
    "monster_kill_goal": 100,
    "difficulty": 0,
    "value": 0,
    "start": {
      "effect": [
        {
          "npc_add_effect": "dm_brew",
          "duration": "3600 s"
        },
        {
          "u_add_effect": "dm_brew",
          "duration": "3600 s"
        }
      ]
    },
    "end": {
      "effect": [
        "stop_following",
        {
          "npc_add_var": "master_mission",
          "type": "count",
          "context": "mission",
          "value": "1"
        },
        {
          "npc_first_topic": "TALK_drunken_master_1"
        }
      ]
    },
    "fail": {
      "effect": [
        "end_conversation",
        "leave"
      ]
    },
    "origins": [
      "ORIGIN_SECONDARY"
    ],
    "followup": "MISSION_drunken_master_3",
    "dialogue": {
      "describe": "-",
      "offer": "-",
      "accepted": "-",
      "rejected": "-",
      "advice": "-",
      "inquire": "-",
      "success": "很高兴看到另一个真正的战士。我很高兴看到你成功地完成了这项任务。现在我需要休息一下。我们晚点再说吧。",
      "success_lie": "-",
      "failure": "更宽松。"
    }
  },
  {
    "id": "MISSION_drunken_master_3",
    "type": "mission_definition",
    "has_generic_rewards": false,
    "name": {
      "str": "白酒配料"
    },
    "description": "收集：\n<color_light_blue>20份烟叶</color>\n<color_light_blue>40份咖啡豆</color>\n<color_light_blue>0.75升威士忌</color>\n<color_light_blue>12块变异肉块</color>",
    "goal": "MGOAL_CONDITION",
    "goal_condition": {
      "and": [
        {
          "u_has_items": {
            "item": "tobacco",
            "count": 20
          }
        },
        {
          "u_has_items": {
            "item": "coffee_bean",
            "count": 40
          }
        },
        {
          "u_has_items": {
            "item": "whiskey",
            "count": 21
          }
        },
        {
          "u_has_items": {
            "item": "mutant_meat",
            "count": 12
          }
        }
      ]
    },
    "difficulty": 0,
    "value": 0,
    "end": {
      "effect": [
        {
          "u_consume_item": "tobacco",
          "count": 20
        },
        {
          "u_consume_item": "coffee_bean",
          "count": 40
        },
        {
          "u_consume_item": "whiskey",
          "count": 4
        },
        {
          "u_consume_item": "mutant_meat",
          "count": 12
        },
        {
          "npc_add_var": "master_mission",
          "type": "count",
          "context": "mission",
          "value": "1"
        },
        {
          "npc_add_var": "wait_time",
          "type": "general",
          "context": "brew",
          "time": true
        },
        {
          "npc_add_var": "wait",
          "type": "general",
          "context": "brew",
          "value": "yes"
        }
      ]
    },
    "origins": [
      "ORIGIN_SECONDARY"
    ],
    "followup": "MISSION_drunken_master_4",
    "dialogue": {
      "describe": "-",
      "offer": "所以，下次喝的时候，我需要一些新东西：20片烟叶，40个咖啡豆，0.75升威士忌，12块变异肉。带我来，我试着从中酿点什么。",
      "accepted": "很好，等你的消息。",
      "rejected": "呸。",
      "advice": "<yawn>",
      "inquire": "你拿到东西了吗？",
      "success": "好吧，现在我需要一些时间让这些东西在我的秘密瓶子里冲泡……据我估计，要花一整天的时间。晚点再来。",
      "success_lie": "-",
      "failure": "-"
    }
  },
  {
    "id": "MISSION_drunken_master_4",
    "type": "mission_definition",
    "has_generic_rewards": false,
    "name": {
      "str": "醉酒大赛"
    },
    "description": "在你清醒之前杀死200个丧尸。",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "ZOMBIE",
    "monster_kill_goal": 200,
    "difficulty": 0,
    "value": 0,
    "start": {
      "effect": [
        {
          "npc_add_effect": "dm_brew",
          "duration": "7200 s"
        },
        {
          "u_add_effect": "dm_brew",
          "duration": "7200 s"
        }
      ]
    },
    "end": {
      "effect": [
        "stop_following",
        {
          "npc_add_var": "master_mission",
          "type": "count",
          "context": "mission",
          "value": "2"
        },
        {
          "npc_first_topic": "TALK_drunken_master_1"
        }
      ]
    },
    "fail": {
      "effect": [
        "end_conversation",
        "leave"
      ]
    },
    "origins": [
      "ORIGIN_SECONDARY"
    ],
    "followup": "MISSION_drunken_master_5",
    "dialogue": {
      "describe": "-",
      "offer": "-",
      "accepted": "-",
      "rejected": "-",
      "advice": "-",
      "inquire": "-",
      "success": "很高兴看到另一个真正的战士。我很高兴看到你成功地完成了这项任务。现在我需要休息一下。我们晚点再说吧。",
      "success_lie": "-",
      "failure": "更宽松。"
    }
  },
  {
    "id": "MISSION_drunken_master_5",
    "type": "mission_definition",
    "has_generic_rewards": false,
    "name": {
      "str": "白酒配料"
    },
    "description": "收集<color_light_blue> 20份硝酸铵</color>、<color_light_blue> 0.3升汽油</color>、<color_light_blue> 15份啤酒花</color>。",
    "goal": "MGOAL_CONDITION",
    "goal_condition": {
      "and": [
        {
          "u_has_items": {
            "item": "chem_ammonium_nitrate",
            "count": 20
          }
        },
        {
          "u_has_items": {
            "item": "gasoline",
            "count": 300
          }
        },
        {
          "u_has_items": {
            "item": "hops",
            "count": 15
          }
        }
      ]
    },
    "difficulty": 0,
    "value": 0,
    "end": {
      "effect": [
        {
          "u_consume_item": "chem_ammonium_nitrate",
          "count": 20
        },
        {
          "u_consume_item": "gasoline",
          "count": 300
        },
        {
          "u_consume_item": "hops",
          "count": 15
        },
        {
          "npc_add_var": "master_mission",
          "type": "count",
          "context": "mission",
          "value": "2"
        },
        {
          "npc_add_var": "wait_time",
          "type": "general",
          "context": "brew",
          "time": true
        },
        {
          "npc_add_var": "wait",
          "type": "general",
          "context": "brew",
          "value": "yes"
        }
      ]
    },
    "origins": [
      "ORIGIN_SECONDARY"
    ],
    "followup": "MISSION_drunken_master_6",
    "dialogue": {
      "describe": "-",
      "offer": "所以下一个泔水会有点异国情调。我不太清楚我的猜测，但我认为添加一点<zombie>信息素可以增强效果…你为什么这样看着我？我没开玩笑！这次我需要：硝酸铵，20片；汽油，0.3升；啤酒花，15片；<zombie>信息素，5片。带我来，我试着从中酿点什么。",
      "accepted": "很好，等你的消息。",
      "rejected": "呸。",
      "advice": "<yawn>",
      "inquire": "你拿到东西了吗？",
      "success": "好吧，现在我需要一些时间让这些东西在我的秘密瓶子里冲泡……据我估计，要花一整天的时间。晚点再来。",
      "success_lie": "-",
      "failure": "-"
    }
  },
  {
    "id": "MISSION_drunken_master_6",
    "type": "mission_definition",
    "has_generic_rewards": false,
    "name": {
      "str": "醉酒大赛"
    },
    "description": "在你清醒之前杀死35个丧尸。",
    "goal": "MGOAL_KILL_MONSTER_TYPE",
    "monster_type": "mon_zombie_brute",
    "monster_kill_goal": 35,
    "difficulty": 0,
    "value": 0,
    "start": {
      "effect": [
        {
          "npc_add_effect": "dm_brew",
          "duration": "14400 s"
        },
        {
          "u_add_effect": "dm_brew",
          "duration": "14400 s"
        }
      ]
    },
    "end": {
      "effect": [
        "stop_following",
        {
          "npc_add_var": "u_helped_drunken_master",
          "type": "general",
          "context": "meeting",
          "value": "yes"
        },
        {
          "npc_add_var": "drunken_master_teach",
          "type": "general",
          "context": "meeting",
          "value": "yes"
        },
        {
          "npc_first_topic": "TALK_drunken_master_1"
        }
      ]
    },
    "fail": {
      "effect": [
        "end_conversation",
        "leave"
      ]
    },
    "origins": [
      "ORIGIN_SECONDARY"
    ],
    "dialogue": {
      "describe": "-",
      "offer": "-",
      "accepted": "-",
      "rejected": "-",
      "advice": "-",
      "inquire": "-",
      "success": "很高兴看到另一个真正的战士。我很高兴看到你成功地完成了这项任务。现在我可以教你我的秘密艺术了。",
      "success_lie": "-",
      "failure": "更宽松。"
    }
  }
]